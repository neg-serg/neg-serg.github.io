---
layout: post
title: Обзор оконных менеджеров
categories: personal
tags: 
  - notion
comments: true
mathjax: null
featured: true
published: true
---

Обзор оконных менеджеров
===================

* TOC
{:toc}

Я пишу эту статью как вводную, перед тем как я расскажу вам о своём форке Notion.
Если вам это не нужно, то можете полистать красивые картинки и сразу пройти __сюда__.

Как всем давно известно в Unix-подобных системах графическая подсистема
отделена от ядра. Самая популярная и универсальная, подходящая практически для
всех юниксов оконная система это X11, которая возглавляется X.Org Foundation.
Подробнее о том что это такое можно почитать где угодно, например на вики, для
тех кто в танке.

Модульность также относится и к составляющей, которая отвечает за управление
окнами. Обычно считается что окнами может управлять только одно приложение,
которое называется оконным менеджером, оно-то и рисует декорации для окон,
обрабатывает реакции на события вроде нажатия хоткеев, смену геометрии окон
и так далее.

Оконных менеджеров очень много, некоторые из них современные, другие не очень,
одни очень популярны, другие почти никому не известны. Всего за время
существования иксов было создано около сотни или двух подобных приложений. Я бы
условно разделил их по модели управления на три категории:

* Стековые -- это такие, которые с плавающими окнами аля os x или windows.
  Самый простой случай, когда это просто обычные "окошки". То что с "табами" на
  уровне оконного менеджера(как, например pekwm или fvwm с некоторыми
  дополнениями) я бы уже рассмотрел как что-то более крутое.

* Тайловые -- которые разбивают оконное пространство подобно тому как это
  делается в screen, tmux или самых старых версиях windows 1.0. Ещё это
  называется статическим тайлингом.

* С динамическим тайлингом -- это понятие чуть более современное чем
  предыдущее, отсчёт, пожалуй, верно будет вести с dwm, по названию которого
  этот класс и назван.

* Гибридные: это, как минимум, наш клиент(notion), также с оговоркой это можно
  было бы отнести к i3, awesome(с плагинами), fvwm и некоторым другим. Отдельно
  этот тип не рассматривается, я их положил или в тайловые или в динамические
  тайловые.

Думаю если я сделаю небольшой обзор этого богатства с парочкой примеров из
каждого типа и скриншотов это будет для всех и эстетически приятно и весело.

Первый тип это стековые. Наверное самые популярные из них это те, которые
входят в состав kde(kwin) и gnome(metacity для версии 2.2+ или mutter для версии
3.x). Но я не буду показывать как они выглядят, потому что мне кажется что вид
этих тяжеловесных монстров испортит мой стройный и красивый блог :)

Как это всё настраивать? Если самим читать документацию и тем более начинать
с нуля лень, то можно посмотреть для начала на <a
href="http://dotshare.it/">dotshare</a> и <a
href="https://bbs.archlinux.org/viewforum.php?id=47">форум арча</a> или на  <a
href="https://www.reddit.com/r/unixporn/">UnixPorn</a>

# Стековые оконные менеджеры

"Классический"(ну, это ещё как сказать вообще-то) и, кстати, самый простой
в плане реализации тип. Всяких мамонтов или проекты, которые вообще никто не
трогает я рассматривать тоже не хочу, потому что зачем говорить о том, что не
интересно самому автору, в то же время если обращать внимание на что-то слишком
банальное вроде Xfwm, openbox и прочего, то это будет скучно.

### <a href="http://incise.org/tinywm.html">TinyWM</a> 

Интересен тем, что почти ничего не делает, так что может использоваться как
отправная точка для других оконных менеджеров. Всего ~50 строк кода. Бывает не
только на си, но и на многих других языках, в частности есть версия на python,
которая использует python-xlib. Показывать по нему особо нечего, но на нем(а
также на <a href="http://www.nongnu.org/stumpwm/">Stumpwm</a>) был основан <a
href="https://common-lisp.net/project/clfswm/">clfswm</a>, о котором рассказано
ниже.

Скриншотов не показываю, потому что показывать нечего.

## Современные

### <a href="https://github.com/venam/2bwm">2bwm</a> 

Это современный форк mcwm(автор Michael Cardell), который в прошлом назывался
mcwm-beast. Работает быстро из-за использования xcb и минималистичности,
довольно популярен, чтобы убедиться в этом достаточно посмотреть, что делают,
например пользователи <a href="https://www.reddit.com/r/unixporn/">UnixPorn</a>
на reddit. Вот его "домашняя" страница: https://github.com/venam/2bwm. Удобен
минимилистичностью, возможностью всем управлять с клавиатуры. В качестве минуса
можно заметить что не все фичи ewmh поддерживаются, а в остальном классный
менеджер, мне нравится. На нем с помощью
<a href="https://github.com/wmutils/core">wmutils</a> может быть реализовано
даже что-то вроде того тайлинга, который был
в <a href="http://subforge.org/projects/subtle">subtle</a>.

Вот как это выглядит(в динамике):
![2bwm_dyn](https://camo.githubusercontent.com/8a9f48b17143699a9aecccc777d7300a25d0aec2/687474703a2f2f626c6f672e7a336272612e6f72672f696d672f323031342d30352d32372d77696e646f77732e676966)
(взято с гитхаба проекта)

![2bwm_scr1](https://i.imgur.com/cvROkwC.png)
(скриншот, сделанный <a href="https://www.reddit.com/user/-Neuromatic-">-Neuromatic-</a>)

Также существуют более минимилистичные <a
href="http://www.6809.org.uk/evilwm/">evilwm</a> и его форк <a
href="https://github.com/jefbed/jbwm">jbwm</a>. jbwm отличается от evilwm
наличием декораций окон и поддержкой xft.  Но как по мне на фоне этого они
не супер. А вот...
    
### <a href="http://monkey.org/~marius/cwm/cwm.1.a">cwm</a> 

А вот написанный, если я не ошибаюсь, специально для openbsd cwm это другое
дело. Он был вдохновлен evilwm, но позднее полностью переписан. Из тех фич,
которые мне в нем нравятся это высокая минималистичность и хорошая скорость
работы, при этом возможность поиска по открытым окнам так как это сделано
например в <a href="http://www.nongnu.org/ratpoison/">Ratpoison</a>. Кстати
насколько я знаю им пользуются Тео де Раадт. Из минусов кроме меньшего кол-ва
фич по сравнению с 2bwm в нем используется синхронный xlib вместо асинхронного
xcb, что делает его не таким быстрым.

![cwm_scr1](http://blog.z3bra.org/img/2013-10-28-final.jpg)
(скриншот, сделанный <a
href="http://blog.z3bra.org/img/2013-10-28-final.jpg">z3bra</a>, правда тут его
чудесного удобного меню не видно, ну да ладно)

## Ностальгические

Любители поностальгировать могут обратить внимание вот на эту троицу:

### <a href="http://www.fvwm.org/">fvwm</a> 

Древний оконный менеджер с огромным количеством функций, плагинов и всего
такого. До сих пор довольно-таки активно развивается. Возможно тем, кому
хочется мысленно вернуться в прошлое он очень подойдет. Используется
в частности Дональдом Кнутом :). (Наверное потому что во времена его молодости
ничего лучше этого не существовало) В качестве особенного плюса, как мне
кажется, стоит выделить отличную поддержку EWMH и ICCCM, не многие оконные
менеджеры могут этим похвастаться, особенно если они не "жирные".

Настроенный fvwm может выглядеть вот так:

![fvwm1](http://pre04.deviantart.net/f466/th/pre/f/2009/336/1/4/fvwm_openbsd___ace_by_pkmurugan.png)
(Скриншот fvwm сделанный <a
href="http://pkmurugan.deviantart.com/">pkmurugan</a> под управлением OpenBSD,
кстати у него вообще довольно много интересных скриншотов и странная любовь
к мелким шрифтам).

Или вот так: 

![fvwm2](http://pre09.deviantart.net/faf0/th/pre/f/2007/225/2/f/fvwm_130807_by_mutze.png)

(Скриншот сделал <a href="http://mutze.deviantart.com/">mutze</a>)

### <a href="http://cgit.freedesktop.org/xorg/app/twm/">twm</a> 

Один из первых и самых простых оконных менеджеров, который часто идет
в комплекте с иксами по-умолчанию. Если вы ничего не вбивали в *~/.xinitrc* то
скорее всего при старте иксов через startx вы получите 3 белых страшных
терминальных окошка xterm(ещё один мамонт), которые управляются этим оконным
менеджеров. По-умолчанию выглядит ужасающе, но его можно настроить. К счастью
не убог, поддерживает декорации окон, иконки, макросы и назначение собственных
хоткеев и реакций на действие мыши.

Например вот его скриншот, который был сделан <a
href="http://earspl1t.deviantart.com/">earspl1t</a>

![twm_screen](http://pre02.deviantart.net/44ad/th/pre/f/2013/343/b/4/arch___twm_by_earspl1t-d6xdypk.png)

Не так уж и плохо для полезного ископаемого, правда?

### <a href="http://windowmaker.org/">Window Maker</a> 

Изначально был разработан для GNUstep DE, которая в свою очередь мимикрировала
под NextSTEP. Это как раз та ос, некоторые куски кода которой ещё содержается
в OS X. Делает это всеми силами и довольно успешно. До сих пор развивается.
Выглядит, как правило, страшновато, потому что им сейчас никто не пользуется.
Ностальгия же.

![windowmaker](http://pre15.deviantart.net/6a78/th/pre/f/2009/248/c/8/openbsd___windowmaker_by_pkmurugan.png)
(Скриншот WindowMaker сделанный  всё тем же <a
href="http://pkmurugan.deviantart.com/">pkmurugan</a> и опять под OpenBSD)

## <a href="https://github.com/wmutils/core">wmutils</a>

В моих глазах это современная реинкарнация <a
href="https://github.com/patrickhaller/no-wm">no-wm</a>, написанная
с использованием xcb. Единым оконным менеджером не является, а представляет
собой набор программ, который подходит для интеграции с уже существующими
EWMH-совместимыми оконными менеджерами. Зачем это нужно? Если добавить ещё
интеграцию <a href="https://github.com/baskerville/sxhkd">sxhkd</a>, то можно
получить универсальную конфигурацию для управления окнами, которая почти не
будет зависеть от конкретного оконного менеджера. Можно использовать даже самые
простые из них, вроде <a href="https://github.com/dcat/swm">swm</a> и не
париться.

Выглядеть может, например, вот так:
![wmutils_scr1](https://raw.githubusercontent.com/Wildefyr/dotfiles/master/screenshots/clean.png)
![wmutils_scr2](http://pub.iotek.org/p/41MwOkW.png)
(скриншоты сделаны <a href="https://github.com/Wildefyr/dotfiles">Wildefyr</a>)

# Динамические тайловые оконные менеджеры 

## <a href="http://dwm.suckless.org/">dwm</a>

Динамический оконный менеджер для иксов. Существуют раскладки, по которым
автомаматически "расфасовываются" окна. Как, например в виде одной большой
области, в виде большого окна и стека, сетки, в виде спирали фиббоначи и тому
подобного. По умолчанию крайне минималистичен, но существуют патчи, которые
позволяет добавить в него недостающее, например поддержку xft шрифтов, более
красивую панель и прочее. Также для него существует множество форков. За что
стоит благодарить политику автора держать объем кода около 5000 loc, что
позволяет разобраться в нем без особых проблем. Существует встроенная панель
и простой лаунчер для приложений. Как и его последователь dwm "динамичен" тем
что вы можете объединить несколько тегов в один, что в общем довольно удобно.
Например если на одном теге у вас программирование, а на другом только web, то
с помощью чего-нибудь вроде control+win+6, если вы на первом рабочем столе вы
объедините 1-ый и шестой. Это просто и понятно, стоит только попробовать.
Единственное чего мне не доставало в нем всегда это невозможность сделать окно
принудительно плавающим при объединении тегов. Короче говоря при слиянии
раскладка другого тега не учитывается, что для меня оказалось сдерживающим
фактором, то же самое касается и awesome, а в остальном очень удобен несмотря
на свою минималистичность, рекомендую, хоть и не использую. Кого-то может
остановить то что он "конфигурируется" с помощью правки исходного кода, но как
по мне там всё довольно просто, к тому же на том же arch forum можно найти "dwm
hacking thread".

Выглядит он обычно примерно вот так, довольно просто:
![dwm1](http://dotshare.it/public/images/uploads/1006.png)
(скриншот пользователя Weidinger взятый с dotshare.it)

За дополнительной информацией рекомендую обратиться на страницу <a
href="https://github.com/Elv13">Elv13</a>

## <a href="http://awesome.naquadah.org/">Awesome</a>

Очень известный динамический тайловый менеджер "следующего поколения", который
является форком dwm, о котором написано выше. Так же как и в ion3
конфигурируется с помощью lua. С одной стороны сам api более красив, приятен
и прост, с другой в отличие от иона api довольно часто меняется, а неправильная
конфигурация может всё(или очень много) поломать. Очень быстр, использует
асинхронную библиотеку xcb, есть встроенная панель, трей, множество плагинов
для самых разных нужд и библиотек виджетов, например таких как замена демонов
десктопных уведомлений(типа dunst, notify-osd и пр.), разнообразных меню
и прочего. Может выглядеть очень красиво. Вообще сам по себе мне очень
нравится. Но не использую, потому что не люблю динамический тайлинг как
таковой, потому что с ним отсутствует ощущение контроля происходящего с окнами
и слишком много частых изменений конфигурации геометрии у окон. А если
отбросить это и использовать на весь экран тогда не хватает некоторых
возможностей того же иона вроде вложенных скратчпадов.

Выглядеть может вот так:

![awesome1_scr](https://camo.githubusercontent.com/1e16c285d9ce13da9530de93033207f2bc600226/687474703a2f2f646f7473686172652e69742f7075626c69632f696d616765732f75706c6f6164732f3635312e706e67)
(Скриншот <a href="https://github.com/copycat-killer">copycat-killer'а</a>)

## <a href="http://wmii.suckless.org/">wmii</a>

Тайловый менеджер для X11. Является, по существу более сложным и, в некотором
роде более богатым на функции, предшественником dwm. Настраивается
и скриптуется через очень интересную, и насколько я знаю, уникальную IPC
систему: монтируется файловая система, которая представляет всю нужную оконному
менеджеру метаинформацию. Изменяя и читая эти данные можно изменять состояние
самого wm, что позволяет писать скрипты для него на любом языке
программирования. По умолчаию используются скрипты на bash, но также можно
работать со всем этим богатством, например, на ruby, по крайней мере это точно
было возможно в прошлом. Есть встроенный лаунчер и панель, также опционально
можно включить и трей. Из минусов, прежде всего бедность фич по сравнению с тем
же ion3, awesome и другими, слабое развитие. Из плюсов: интересная IPC
архитектура из-за чего и упомянут.

Выглядит вот так:
![wmii1](http://pre03.deviantart.net/bf9b/th/pre/f/2012/258/6/b/still_alive_by_n0tch2k-d5es3aq.png)
(скриншот пользователя <a href="http://n0tch2k.deviantart.com/">n0tch2k</a>

## <a href="http://i3wm.org/">i3</a>

Тайловый оконный менеджер, который был написан полностью с нуля. Был создан
потому что wmii не предоставлял(по крайней мере тогда) некоторых нужных
функций, вроде поддержки мультимониторных конфигураций, имел некоторые баги
и к тому же практически не развивался, а взять и похачить его было сложно из-за
довольно большого объема кода и бедности документации. На самом деле с wmii
имеет довольно мало общего и напоминает он мне скорее упрощенный ion3,
в основном потому что представляет окна, насколько я помню, в виде дерева, а не
в виде стека. Настраивается с помощью обычного текстового конфигурационного
файла, IPC аля plan9 из wmii здесь, к сожалению, отсутствует.

Выглядит вот так:

![i3scr1](http://dotshare.it/public/images/uploads/1056.png)
(скриншот пользователя <a href="http://dotshare.it/~twodogsdave/">twodogsdave</a>)

## <a href="https://github.com/sulami/FrankenWM">FrankenWM</a>

Ещё один динамический тайловый менеджер, отличается прежде всего использованием
xcb и простотой, даже более прост, чем dwm, всего около 2 тысяч строк кода.
Можно с большой оговоркой рассматривать его как что-то вроде тайлового 2bwm,
собственно в нем оттуда даже куски кода используются с той лишь разницей что
wmutils вы в полном объеме к нему не прикрутите.

## <a href="https://github.com/conformal/spectrwm/wiki">spectrwm</a>

Оконный менеджер, который похож на более дружелюбный по отношению
к пользователю dwm. Настраивается через конфигурационный файл, а не с помощью
перекомпиляции, поддерживает ewmh, xrandr, встроенные зазоры(gap). Развивается
не очень активно, но упомянуть можно. Утверждается что сделан "хакерами для
хакеров". Ну хз, возможно.

## <a href="https://github.com/qtile/qtile">Qtile</a>

Ещё один оконный менеджер, который неплохо выглядит, благодаря встроенным
виджетам, имеет довольно стандартные функции, хорошо конфигурируется...
с помощью python. Чем и интересен. То есть написан на pure python, а не так как
например subtle wm си с ruby-интерфейсом или ion3 с lua интерфейсом.

Выглядит он просто и со вкусом:
![qtile1](http://www.qtile.org/static/img/screenshots/linuxville.png)
(скриншот взят с сайта проекта)

## <a href="http://xmonad.org/">xmonad</a>

Динамический оконный менеджер, который полностью написан на haskell. На нем же
и конфигурируется. По-умолчанию в голом виде довольно похож на dwm и кажется
убогим, но библиотека xmonad contrib добавляет в него множество раскладок,
возможность полного ручного контроля структуры данных для управления
окнами(используется стек, к сожалению), декорации окон, и многое, многое
другое. Содержит буквально сотни мелких дополнений. Как его настраивать можно
найти прямо на его сайте. Требует установки компилятора haskell, который
де-факто GHC. Достаточно тяжел, весит около 800 MiB, что может стать
препятствием для минималистов, жадин или обладателей маленького ssd.

# Тайловые оконные менеджеры

##  <a href="https://github.com/baskerville/bspwm">Bspwm</a>

bspwm -- это тайловый оконный менеджер, который как это понятно по названию,
представляет окна в виде бинарного дерева, каждый узел которого имеет по два
потомка. Поддерживает EWMH и многомониторные конфигурации. Контроллируется
с помощью сообщений, которые посылает утилита bspc, в сокет, что удобно.
Позволяет организовать, например, интеграцию с <a
href="https://github.com/baskerville/sxhkd">sxhkd</a>. Активно развивается,
в настоящее время довольно популярен у красноглазиков.

![bspwm_scr](https://u.teknik.io/jjv1Uj.png)
(скриншот, который сделал <a href="https://www.reddit.com/user/Neeasade">Neeasade</a>)
Ссылка на него чтобы рассмотреть получше <a href="https://u.teknik.io/jjv1Uj.png">[link]</a>

## <a href="http://herbstluftwm.org">Herbstluftwm</a>

Оконный менеджер с ручным статическим тайлингом, который использует Xlib
и Glib. Работа с окнами осуществляется через разбитие пространства на фреймы,
то есть неперекрывающиеся области, примерно так же как в ion3. Так же как
и в ионе могут динамически создаваться рабочие столы. Каждый рабочий стол имеет
собственную раскладку фреймов. 

* Что хорошо: Современных оконных менеджеров со статическим тайлингом не так
  много что уже хорошо. Управляется через IPC вызовы от herbstclient, так что
  вся конфигурация может быть сделана даже обычным шелл-скриптом(непрямая
  аналогия с wmii). 

* Что плохо: ion3 в целом более фичаст, проект почти перестал развиваться, не
  всегда адекватная реакция на ewmh-события, особенно которые связаны
  с плавающими "мониторами"(местный аналог скратчпадов).

Как выглядит:

![herbst_scr1](http://dotshare.it/public/images/uploads/720.png)
(скриншот конфигурации <a href="http://dotshare.it/public/images/uploads/720.png">milomouse</a>)

## <a href="https://github.com/HarveyHunt/howm">howm</a>

Минимилистичный оконный менеджер, который интересен тем, что стремится быть
похожим в плане модели управления на vi. У меня как-то недавно спросили бывают
ли оконные менеджеры с похожей на vi модальной раскладкой клавиатурных
комбинаций. Ну вот, бывают. Конфигурируется через config.h с перекомпиляцией,
впрочем в этом нет ничего сложного. А вот как это чудо выглядит в динамике:

![howm1](https://camo.githubusercontent.com/a6538caf18ac1d4a930d3f260e3ac4dbfd1eea94/687474703a2f2f692e696d6775722e636f6d2f7479695a634c782e676966)
![howm2](https://camo.githubusercontent.com/f42d3c43b6f44a9e714d48862ebda4bdd24a8a47/687474703a2f2f692e696d6775722e636f6d2f34735736526c542e676966)

## <a href="http://www.nongnu.org/ratpoison/">Ratpoison</a>

Простой оконный менеджер, который не имеет большого количества зависимостей,
свистелок и перделок, декораций окон и терпимости к грызунам. Был вдохновлен
GNU Screen, его название переводится как "крысиный яд", то есть wm для
настоящих кейбордистов. Панели нет(впрочем можно прикрутить), информация
выводится только по требованию, конфигурация осуществляется через простой
текстовый файл. Трея тоже нет. Строг, минималистичен. Почему-то работать за ним
довольно приятно. Из минусов -- мало фич, отсутствуют плавающие окна
и скратчпады. Из плюсов -- это "тру" тайловый wm каким он и должен быть.

## <a href="http://www.nongnu.org/stumpwm/">Stumpwm</a>

Оконный менеджер со статическим тайлингом от предыдущего автора, который по
сути представляет собой улучшенный ratpoison, переписанный на common lisp, что
позволяет ему быть переконфигурированным или даже полностью переписанным без
перезапуска, по функциональности они довольно-таки похожи. Довольно
минималистичен, но неплохо настраивается. Также как и в случае ratpoison нет
декораций окон, нет кнопок, нет трея, ничего нет, только окна и клавиатура.
Зато в отличие от ratpoison есть встроенная панель.

Он может выглядеть, например, вот так:

![stumpwm_scr1](http://dotshare.it/public/images/uploads/406.png)
(скриншот <a href="http://dotshare.it/~crshd/">crshd</a>)

## <a href="https://common-lisp.net/project/clfswm/">clfswm</a>

Творение очень странное, даже не понятно к какому бы типу его следовало
отнести. Написан на common lisp, так что может быть не только перенастроен, но
даже полностью переписан без перезапуска. Возможно есть извращенцы, которым
понравится настолько странный wm, чтобы понять что с ним не так просто пройдите
по ссылке. Похоже что проектировался он для мониторов 4K, раз так расточительно
относится к экранному пространству :D

## <a href="http://tuomov.iki.fi/software">Ion3</a> и <a href="http://notion.sf.net/">Notion</a> 

Ion3 -- это wm в котором сделан упор на управление с клавиатуры. Наряду
с larswm один из первых представителей вида static tiling wm. Прошел долгое и бурное
развитие, которое осуществлялось преимущественно странноватым товарищем <a
href="http://tuomov.iki.fi/">Tuomo Valkonen</a>, который в один прекрасный день
разочаровался в linux и ушел прогать под винду. Странность его(автора),
например в том что он то менял лицензию, когда не хотел поддерживать древние
версии ion в debian, из-за чего эти товарищи даже клали его в nonfree, то
упорно отказывался добавить поддрежку xft, то ещё что. А потом в один
прекрасный день вообще закрыл сайт с проектом, потому что ему показалось что
активного развития нет и патчей никто не присылает. Тогда из тех запасов что
имелись были сделаны несколько форков из которых жизнеспособным оказался
Notion. О нем и расскажу, потому что современный, отличия невелики.

Вот как может выглядеть ion3:
![ion3_scr1](https://www.opennet.ru/docs/RUS/ion3/moc_and_conky.png)
(скриншот <a href="http://raze-overdrive.livejournal.com/">warl0ck'а</a>,
опубликованный на opennet много лет назад)

![ion3_scr2](https://www.linux.org.ru/gallery/6411362.png)
(а этот скриншот сделан <a href="https://www.linux.org.ru/gallery/10970869.png">мной</a>, но без всех усовершенствований, которые были
сделаны после, он старый, просто для примера)

Сразу скажу что это мой любимый оконный менеджер и он действительно не имеет
прямых аналогов. Позволяет писать расширения на lua и конфиг на нем
же. О нем рассказывается отдельно в <a href="">этой статье</a>, потому что
мной был сделан его форк, который придает ему более современный вид,
также довольно сильно изменилась конфигурация и многое другое, что тянет
на целую статью.
